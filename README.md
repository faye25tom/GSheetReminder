### **Google Apps Script 时间提醒脚本 (邮件通知 \+ 状态自动重置)**

这个脚本将帮助你在 Google Sheets 中设置基于时间的提醒（通过电子邮件发送通知），并且增加了自动重置提醒状态的功能。

**工作原理:**

1. **指定检查范围:** 你需要在脚本中设置要监控的包含时间的列（例如，'A' 列）、提醒状态列（例如，'B' 列）和提醒内容列（例如，'C' 列）。  
2. 时间触发器 (用于邮件提醒): 你需要设置一个时间驱动的触发器（例如，每分钟运行一次），让脚本 (checkTimeReminders 函数) 定期检查时间并发邮件。  
3. 检查时间 (邮件提醒): checkTimeReminders 函数会遍历指定列中的每个单元格。  
4. 比较时间 (邮件提醒): 如果单元格包含有效的时间，并且该时间等于或早于当前时间，并且尚未发送提醒（通过检查状态列），脚本就会触发邮件提醒。  
5. 发送邮件提醒: 脚本会向运行脚本的用户发送一封电子邮件，邮件主题和正文包含提醒信息。  
6. 标记已提醒: 提醒邮件发出后，脚本会在状态列中标记 "提醒已发送"。  
7. 编辑触发器 (用于状态重置): 新增的 onEdit 函数会在你每次编辑电子表格时自动运行。  
8. 检查编辑内容 (状态重置): onEdit 函数会检查你是否修改了时间列 ('A' 列)。  
9. 自动清除状态 (状态重置): 如果你将 'A' 列的某个时间修改为晚于当前时间的新时间，onEdit 函数会自动清除同一行 'B' 列的状态标记（例如 "提醒已发送"），以便该提醒可以在新的时间到达时再次触发。

**如何使用:**

1. 打开你的 Google Sheet 表格。  
2. 点击菜单栏的 "扩展" (Extensions) \-\> "Apps Script"。  
3. 将下面**更新后的代码**复制并粘贴到脚本编辑器中，替换掉你之前粘贴的所有代码。  
4. 修改脚本配置 (如果需要):  
   * SHEET\_NAME: 确认是你的工作表名称。  
   * TIME\_COLUMN\_LETTER: 确认是包含提醒时间的列字母 ('A')。  
   * STATUS\_COLUMN\_LETTER: 确认是用于标记提醒状态的列字母 ('B')。  
   * MESSAGE\_COLUMN\_LETTER: 确认是包含提醒内容的列字母 ('C')。  
5. 保存脚本（点击软盘图标）。  
6. 检查时间驱动触发器:  
   * 确保你仍然有一个为 checkTimeReminders 函数设置的时间驱动触发器（用于邮件提醒）。如果没有或需要修改，请参考之前的步骤进行设置。  
   * 注意: 你不需要为新的 onEdit 函数设置触发器，它会自动工作。  
7. 授权: 如果你之前已经授权过，可能不需要再次授权。但如果脚本编辑器提示，请根据需要重新授权。

现在，脚本不仅会在时间到达时通过邮件提醒你，还会在你将提醒时间向后修改时自动清除旧的提醒状态。
