## **Google Apps Script 时间提醒脚本 (邮件通知 \+ 状态自动重置) ⏰📧🔄**

这个脚本将帮助你在 Google Sheets 中设置基于时间的提醒，并通过电子邮件发送通知。更棒的是，它还增加了自动重置提醒状态的功能！🚀

**核心功能：**

* **时间提醒 📧:** 再也不会错过重要的事情！  
* **邮件通知 📬:** 直接将提醒发送到你的邮箱。  
* **状态自动重置 🔄:** 修改时间后，提醒状态自动更新，确保提醒准确无误。

### **工作原理 ⚙️**

1. **指定检查范围 🔍:**  
   * 你需要告诉脚本在哪里查看时间、提醒状态和提醒内容。  
   * 例如：  
     * 时间列：'A'  
     * 状态列：'B'  
     * 内容列：'C'  
2. **时间触发器 (邮件提醒) ⏱️:**  
   * 你需要设置一个时间触发器，让脚本定期检查时间并发送邮件。  
   * 例如，你可以设置每分钟运行一次。  
3. **检查时间 (邮件提醒) 👀:**  
   * checkTimeReminders 函数会遍历你指定的列中的每个单元格，查看是否有需要发送的提醒。  
4. **比较时间 (邮件提醒) 🧐:**  
   * 如果单元格中的时间等于或早于当前时间，并且提醒尚未发送（通过检查状态列），脚本就会触发邮件提醒。  
5. **发送邮件提醒 📨:**  
   * 脚本会向你（运行脚本的用户）发送一封电子邮件，邮件的主题和正文包含提醒信息。  
6. **标记已提醒 ✅:**  
   * 提醒邮件发送后，脚本会在状态列中标记 "提醒已发送"，避免重复发送。  
7. **编辑触发器 (状态重置) ✏️:**  
   * 新增的 onEdit 函数会在你每次编辑电子表格时自动运行。  
8. **检查编辑内容 (状态重置) 🕵️:**  
   * onEdit 函数会检查你是否修改了时间列（例如，'A' 列）。  
9. **自动清除状态 (状态重置) 🧹:**  
   * 如果你将时间列中的某个时间修改为晚于当前时间的新时间，onEdit 函数会自动清除同一行状态列的状态标记（例如，"提醒已发送"）。这样，当新的时间到达时，提醒可以再次触发。

### **如何使用 🚀**

1. **打开你的 Google Sheet 表格 📑。**  
2. **打开 Apps Script 编辑器 👨‍💻:**  
   * 点击菜单栏的 "扩展" (Extensions) \-\> "Apps Script"。  
3. **复制脚本代码 📋:**  
   * 将 checkTimeReminders.gs 中的代码复制并粘贴到脚本编辑器中，替换掉你之前粘贴的所有代码。  
4. **修改脚本配置 (如果需要) ⚙️:**  
   * **重要：** 在脚本的全局配置区，确保以下变量设置正确：  
     * SHEET\_NAME: 你的工作表名称 🏷️  
     * TIME\_COLUMN\_LETTER: 包含提醒时间的列字母 (例如 'A') 📅  
     * STATUS\_COLUMN\_LETTER: 用于标记提醒状态的列字母 (例如 'B') 🚩  
     * MESSAGE\_COLUMN\_LETTER: 包含提醒内容的列字母 (例如 'C') 📝  
     * SENT\_STATUS\_TEXT: 状态列中标记已发送提醒的文本 (例如 "提醒已发送")。 **请注意，代码中添加了这个变量的说明，你也需要在文档中添加**  
5. **保存脚本 💾:**  
   * 点击软盘图标保存你的更改。  
6. **设置或检查触发器 ⏰:**  
   * **如果你之前已经设置了触发器:**  
     * 请确保它仍然存在并且配置正确（运行 checkTimeReminders 函数，事件来源为 "时间驱动"，类型为 "分钟计时器"）。  
   * **如果尚未设置触发器:**  
     1. 在脚本编辑器左侧菜单中，点击时钟图标（触发器 Triggers）。  
     2. 点击右下角的 "+ 添加触发器" (+ Add Trigger)。  
     3. 配置触发器：  
        * 选择要运行的函数：checkTimeReminders  
        * 选择应部署的部署：Head  
        * 选择事件来源：时间驱动 (Time-driven)  
        * 选择时间触发器类型：分钟计时器 (Minutes timer)  
        * 选择分钟间隔：每分钟 (Every minute) 或根据你的需要选择其他频率。  
        * 错误通知设置：根据需要选择。  
     4. 点击 "保存"。  
7. **授权 🔑:**  
   * 如果你之前已经授权过，可能不需要再次授权。但如果脚本编辑器提示，请根据需要重新授权。

现在，你的脚本已经设置好了！它会在指定的时间通过邮件提醒你，并且在你修改提醒时间时自动更新提醒状态。🎉
